#include "NVIDIA_H100_NVL.h"

namespace dorado::basecall {

void AddNVIDIA_H100_NVLBenchmarks(std::map<std::pair<std::string, std::string>,
                                           std::unordered_map<int, float>>& chunk_benchmarks) {
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_260bps_fast@v4.1.0"}] = {
            {64, 0.071481f},   {128, 0.0383893f}, {192, 0.0272868f},  {256, 0.0212933f},
            {320, 0.0186691f}, {384, 0.0162043f}, {448, 0.0145084f},  {512, 0.0131682f},
            {832, 0.0128464f}, {960, 0.0123077f}, {2560, 0.0119397f}, {4096, 0.0117774f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_260bps_hac@v4.1.0"}] = {
            {64, 1.05241f},     {128, 0.533845f},   {192, 0.365859f},   {256, 0.274192f},
            {320, 0.230333f},   {384, 0.184178f},   {448, 0.160396f},   {512, 0.140429f},
            {576, 0.125611f},   {640, 0.111931f},   {704, 0.104245f},   {768, 0.0955695f},
            {832, 0.0880751f},  {896, 0.0821424f},  {960, 0.0778865f},  {1024, 0.0726451f},
            {1088, 0.069376f},  {1152, 0.0672124f}, {1216, 0.0643985f}, {1280, 0.0641247f},
            {1344, 0.0592631f}, {1408, 0.059109f},  {1536, 0.0563128f}, {1600, 0.0550069f},
            {1664, 0.0533068f}, {1728, 0.0523681f}, {1792, 0.0517354f}, {1856, 0.0515155f},
            {1920, 0.0514364f}, {1984, 0.0494992f}, {2048, 0.0480919f}, {2176, 0.0468474f},
            {2240, 0.04646f},   {2304, 0.0455841f}, {2368, 0.0453528f}, {2496, 0.0451137f},
            {2560, 0.0436925f}, {2880, 0.0419387f}, {3008, 0.0417775f}, {3264, 0.0413613f},
            {3392, 0.0402869f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_260bps_sup@v4.1.0"}] = {
            {64, 2.48871f},    {128, 1.238f},     {192, 0.842823f}, {256, 0.644058f},
            {320, 0.515976f},  {384, 0.458274f},  {448, 0.405937f}, {512, 0.378696f},
            {576, 0.35941f},   {640, 0.332596f},  {704, 0.317819f}, {768, 0.305968f},
            {832, 0.293801f},  {896, 0.284567f},  {960, 0.276884f}, {1024, 0.270653f},
            {1344, 0.268754f}, {1408, 0.266309f}, {1920, 0.26269f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v4.1.0"}] = {
            {64, 0.0716225f},   {128, 0.0387908f},  {192, 0.027449f},  {256, 0.021324f},
            {320, 0.0189466f},  {384, 0.0162107f},  {448, 0.0145831f}, {512, 0.0131331f},
            {768, 0.013017f},   {832, 0.0129428f},  {896, 0.012428f},  {1728, 0.0124156f},
            {2048, 0.0119208f}, {3776, 0.0116774f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v4.3.0"}] = {
            {64, 0.0604025f},   {128, 0.033692f},  {192, 0.0236383f},   {256, 0.0184198f},
            {320, 0.0162697f},  {384, 0.0140735f}, {448, 0.0126876f},   {512, 0.0115794f},
            {1024, 0.0103649f}, {1472, 0.010191f}, {1536, 0.00992827f}, {2112, 0.0095475f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v5.0.0"}] = {
            {64, 0.060338f},   {128, 0.0332193f}, {192, 0.0235792f}, {256, 0.0184214f},
            {320, 0.0162572f}, {384, 0.014052f},  {448, 0.0126781f}, {512, 0.0114381f},
            {832, 0.0113163f}, {896, 0.0109453f}, {960, 0.0101719f}, {1024, 0.009719f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v4.1.0"}] = {
            {64, 1.08737f},     {128, 0.53456f},    {192, 0.483934f},   {256, 0.281258f},
            {320, 0.219478f},   {384, 0.189475f},   {448, 0.157532f},   {512, 0.140059f},
            {576, 0.12652f},    {640, 0.112516f},   {704, 0.103596f},   {768, 0.0951948f},
            {832, 0.088532f},   {896, 0.0848741f},  {960, 0.0767071f},  {1024, 0.0731488f},
            {1088, 0.0697472f}, {1216, 0.0643757f}, {1280, 0.0624668f}, {1344, 0.0603221f},
            {1408, 0.0584783f}, {1472, 0.0581617f}, {1536, 0.0565798f}, {1600, 0.0551472f},
            {1664, 0.053698f},  {1728, 0.0529209f}, {1792, 0.0513774f}, {1984, 0.0500986f},
            {2048, 0.048642f},  {2112, 0.0483321f}, {2176, 0.0470705f}, {2240, 0.0467836f},
            {2368, 0.0458579f}, {2496, 0.0444891f}, {2752, 0.042606f},  {3136, 0.0416562f},
            {3200, 0.0413375f}, {3392, 0.0408933f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v4.3.0"}] = {
            {64, 0.84007f},     {128, 0.417376f},   {192, 0.289035f},   {256, 0.214484f},
            {320, 0.171339f},   {384, 0.145074f},   {448, 0.125533f},   {512, 0.110915f},
            {576, 0.0976522f},  {640, 0.088018f},   {704, 0.0820281f},  {768, 0.0738386f},
            {832, 0.0697651f},  {896, 0.0649479f},  {960, 0.0620159f},  {1024, 0.0572697f},
            {1088, 0.0543696f}, {1152, 0.0515402f}, {1216, 0.0491775f}, {1280, 0.0466099f},
            {1344, 0.0453608f}, {1408, 0.042837f},  {1472, 0.0417589f}, {1536, 0.0399173f},
            {1600, 0.0386821f}, {1664, 0.0373405f}, {1728, 0.0361232f}, {1856, 0.0343653f},
            {1920, 0.0332029f}, {1984, 0.0327066f}, {2112, 0.0313446f}, {2240, 0.030297f},
            {2304, 0.0293377f}, {2368, 0.028579f},  {2496, 0.027921f},  {2560, 0.027657f},
            {2624, 0.0274505f}, {2688, 0.026968f},  {2752, 0.0268198f}, {2880, 0.0261829f},
            {3008, 0.0253427f}, {3264, 0.0244747f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v5.0.0"}] = {
            {64, 0.936881f},    {128, 0.424511f},   {192, 0.285184f},   {256, 0.21458f},
            {320, 0.18225f},    {384, 0.145175f},   {448, 0.124702f},   {512, 0.109005f},
            {576, 0.102383f},   {640, 0.0873034f},  {704, 0.0793643f},  {768, 0.0740628f},
            {832, 0.0698442f},  {896, 0.0646683f},  {960, 0.0609647f},  {1024, 0.0573566f},
            {1088, 0.0542781f}, {1152, 0.0513223f}, {1216, 0.0489946f}, {1280, 0.0470144f},
            {1344, 0.0449849f}, {1408, 0.0427831f}, {1536, 0.0406643f}, {1600, 0.0389094f},
            {1664, 0.0387474f}, {1728, 0.0376255f}, {1792, 0.0351673f}, {1856, 0.0346211f},
            {1920, 0.033613f},  {1984, 0.0328811f}, {2048, 0.0320272f}, {2112, 0.0311295f},
            {2176, 0.0304109f}, {2240, 0.029502f},  {2304, 0.0290963f}, {2368, 0.0283228f},
            {2432, 0.0283091f}, {2496, 0.0277591f}, {2624, 0.0267126f}, {2752, 0.0263392f},
            {3008, 0.0245464f}, {3520, 0.0243204f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v4.1.0"}] = {
            {64, 2.46489f},    {128, 1.24412f},   {192, 0.835338f}, {256, 0.636188f},
            {320, 0.527731f},  {384, 0.454027f},  {448, 0.405159f}, {512, 0.378284f},
            {576, 0.365553f},  {640, 0.337043f},  {704, 0.319939f}, {768, 0.306874f},
            {832, 0.296435f},  {896, 0.284908f},  {960, 0.275537f}, {1024, 0.267306f},
            {1408, 0.266321f}, {1920, 0.264288f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v4.3.0"}] = {
            {64, 2.13128f},    {128, 1.07874f},   {192, 0.721682f},  {256, 0.542825f},
            {320, 0.449492f},  {384, 0.373756f},  {448, 0.335283f},  {512, 0.288148f},
            {576, 0.277444f},  {640, 0.260923f},  {704, 0.248457f},  {768, 0.230445f},
            {896, 0.218387f},  {960, 0.203906f},  {1024, 0.19705f},  {1664, 0.196604f},
            {1792, 0.196161f}, {1920, 0.194501f}, {2368, 0.194455f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v5.0.0"}] = {
            {32, 1.06904f},   {64, 0.659935f},  {96, 0.486297f},  {128, 0.402063f},
            {160, 0.399172f}, {256, 0.371334f}, {352, 0.346864f}, {448, 0.342875f},
            {512, 0.334273f}, {640, 0.328627f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r9.4.1_e8_fast@v3.4"}] = {
            {64, 0.118668f},    {128, 0.0618538f},  {192, 0.0427735f},  {256, 0.0331816f},
            {320, 0.0275392f},  {384, 0.0236125f},  {448, 0.0209503f},  {512, 0.0188812f},
            {768, 0.0182755f},  {832, 0.0181256f},  {896, 0.0175626f},  {960, 0.0175326f},
            {1024, 0.0172881f}, {1408, 0.0170964f}, {1472, 0.0159568f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r9.4.1_e8_hac@v3.3"}] = {
            {64, 1.05627f},     {128, 0.539173f},   {192, 0.36566f},    {256, 0.29782f},
            {320, 0.219072f},   {384, 0.187744f},   {448, 0.162619f},   {512, 0.141921f},
            {576, 0.125216f},   {640, 0.124341f},   {704, 0.105855f},   {768, 0.0961874f},
            {832, 0.0916948f},  {896, 0.0822147f},  {960, 0.0772277f},  {1024, 0.0731626f},
            {1088, 0.0728636f}, {1152, 0.067941f},  {1216, 0.0639899f}, {1280, 0.0618792f},
            {1344, 0.0581171f}, {1472, 0.0572668f}, {1536, 0.056085f},  {1600, 0.0538119f},
            {1664, 0.052261f},  {1728, 0.052093f},  {1792, 0.0512089f}, {1856, 0.0496893f},
            {1984, 0.0483742f}, {2048, 0.0480938f}, {2112, 0.0477295f}, {2176, 0.0466326f},
            {2240, 0.0453842f}, {2304, 0.0440534f}, {2368, 0.0431054f}, {2688, 0.0428447f},
            {2752, 0.0424697f}, {2880, 0.0416776f}, {3008, 0.0405716f}, {3136, 0.0404969f},
            {3392, 0.0402704f}, {6976, 0.0402093f}, {7040, 0.0400231f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r9.4.1_e8_sup@v3.3"}] = {
            {64, 2.11934f},    {128, 1.07089f},   {192, 0.785928f},  {256, 0.545059f},
            {320, 0.438309f},  {384, 0.372516f},  {448, 0.327336f},  {512, 0.289547f},
            {576, 0.272759f},  {640, 0.257144f},  {704, 0.240901f},  {768, 0.230845f},
            {832, 0.218352f},  {896, 0.207948f},  {1024, 0.197793f}, {1088, 0.196721f},
            {1152, 0.18951f},  {1216, 0.185949f}, {1280, 0.182638f}, {1344, 0.179293f},
            {1408, 0.176872f}, {2112, 0.17673f},  {2240, 0.176453f}, {2368, 0.175868f},
            {2560, 0.175465f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_fast@v5.1.0"}] = {
            {64, 0.06891f},     {128, 0.0367485f},  {192, 0.0258808f},  {256, 0.0202738f},
            {320, 0.0171969f},  {384, 0.0149813f},  {448, 0.013334f},   {512, 0.0123299f},
            {960, 0.0123197f},  {1024, 0.0120658f}, {1536, 0.0118512f}, {1664, 0.0116838f},
            {1728, 0.0115277f}, {1792, 0.0107293f}, {2496, 0.0105037f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_hac@v5.1.0"}] = {
            {64, 0.994028f},    {128, 0.550547f},   {192, 0.34075f},    {256, 0.258327f},
            {320, 0.213594f},   {384, 0.174351f},   {448, 0.148182f},   {512, 0.132462f},
            {640, 0.105302f},   {704, 0.0976593f},  {768, 0.0886602f},  {832, 0.0831463f},
            {896, 0.0778311f},  {960, 0.0723053f},  {1024, 0.0698615f}, {1088, 0.0650355f},
            {1152, 0.0617132f}, {1216, 0.0590287f}, {1280, 0.0559802f}, {1344, 0.0539015f},
            {1408, 0.0518557f}, {1472, 0.050391f},  {1536, 0.0479985f}, {1600, 0.0462302f},
            {1664, 0.0449848f}, {1728, 0.0437252f}, {1792, 0.0422275f}, {1856, 0.0416879f},
            {1920, 0.0402848f}, {1984, 0.0392237f}, {2048, 0.0381219f}, {2112, 0.0373906f},
            {2240, 0.0363533f}, {2368, 0.0339871f}, {2560, 0.0337946f}, {2624, 0.0334085f},
            {2816, 0.0327639f}, {2880, 0.0312725f}, {3200, 0.0301318f}, {3264, 0.0299586f},
            {3392, 0.0299015f}, {3456, 0.029888f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_sup@v5.1.0"}] = {
            {32, 1.21107f},   {64, 0.784522f}, {96, 0.58518f},   {128, 0.581281f}, {160, 0.574654f},
            {256, 0.523842f}, {288, 0.52323f}, {320, 0.504634f}, {608, 0.502565f},
    };
}

}  // namespace dorado::basecall
