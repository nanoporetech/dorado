#include "NVIDIA_H100_NVL.h"

namespace dorado::basecall {

void AddNVIDIA_H100_NVLBenchmarks(std::map<std::pair<std::string, std::string>,
                                           std::unordered_map<int, float>>& chunk_benchmarks) {
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v4.3.0"}] = {
            {64, 0.0604025f},   {128, 0.033692f},  {192, 0.0236383f},   {256, 0.0184198f},
            {320, 0.0162697f},  {384, 0.0140735f}, {448, 0.0126876f},   {512, 0.0115794f},
            {1024, 0.0103649f}, {1472, 0.010191f}, {1536, 0.00992827f}, {2112, 0.0095475f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v5.0.0"}] = {
            {64, 0.060338f},   {128, 0.0332193f}, {192, 0.0235792f}, {256, 0.0184214f},
            {320, 0.0162572f}, {384, 0.014052f},  {448, 0.0126781f}, {512, 0.0114381f},
            {832, 0.0113163f}, {896, 0.0109453f}, {960, 0.0101719f}, {1024, 0.009719f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v4.3.0"}] = {
            {64, 0.813738f},    {128, 0.409522f},   {192, 0.282472f},   {256, 0.21243f},
            {320, 0.169894f},   {384, 0.145286f},   {448, 0.122164f},   {512, 0.109301f},
            {576, 0.0969048f},  {640, 0.0888201f},  {704, 0.0810834f},  {768, 0.0741263f},
            {832, 0.0699115f},  {896, 0.0640864f},  {960, 0.0609315f},  {1024, 0.057643f},
            {1088, 0.0546853f}, {1152, 0.0519542f}, {1216, 0.0497997f}, {1280, 0.0472997f},
            {1344, 0.0452006f}, {1408, 0.0427131f}, {1472, 0.0418492f}, {1536, 0.0400441f},
            {1600, 0.0387812f}, {1664, 0.0376583f}, {1728, 0.0362752f}, {1792, 0.0356345f},
            {1856, 0.0351562f}, {1920, 0.0335963f}, {1984, 0.0331019f}, {2048, 0.0317895f},
            {2112, 0.0310847f}, {2176, 0.030503f},  {2240, 0.0299861f}, {2304, 0.0292931f},
            {2368, 0.0288303f}, {2432, 0.0283956f}, {2496, 0.0277362f}, {2560, 0.0270889f},
            {2624, 0.0267041f}, {2688, 0.026682f},  {2752, 0.0263581f}, {2816, 0.0260221f},
            {2944, 0.0253629f}, {3072, 0.0250929f}, {3200, 0.024361f},  {3328, 0.023971f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v5.0.0"}] = {
            {64, 0.806916f},    {128, 0.407495f},   {192, 0.278852f},   {256, 0.209938f},
            {320, 0.16918f},    {384, 0.143219f},   {448, 0.12318f},    {512, 0.108763f},
            {576, 0.097143f},   {640, 0.087722f},   {704, 0.0806559f},  {768, 0.0739909f},
            {832, 0.0694618f},  {896, 0.0639729f},  {960, 0.0612259f},  {1024, 0.056857f},
            {1088, 0.0543976f}, {1152, 0.0520867f}, {1216, 0.0491463f}, {1280, 0.0469463f},
            {1344, 0.0450523f}, {1408, 0.0431556f}, {1472, 0.0416604f}, {1536, 0.040069f},
            {1600, 0.0385445f}, {1664, 0.0376838f}, {1728, 0.0362004f}, {1792, 0.0355107f},
            {1856, 0.0347244f}, {1920, 0.0333377f}, {1984, 0.0327645f}, {2048, 0.0321795f},
            {2112, 0.0315643f}, {2176, 0.0304453f}, {2240, 0.0302279f}, {2304, 0.0296725f},
            {2368, 0.0286127f}, {2432, 0.0284459f}, {2496, 0.0276907f}, {2560, 0.027314f},
            {2752, 0.0265145f}, {2816, 0.0263174f}, {2880, 0.0261495f}, {3008, 0.025875f},
            {3072, 0.0254567f}, {3200, 0.0245873f}, {3456, 0.0245149f}, {3520, 0.0238068f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v4.3.0"}] = {
            {64, 2.13128f},    {128, 1.07874f},   {192, 0.721682f},  {256, 0.542825f},
            {320, 0.449492f},  {384, 0.373756f},  {448, 0.335283f},  {512, 0.288148f},
            {576, 0.277444f},  {640, 0.260923f},  {704, 0.248457f},  {768, 0.230445f},
            {896, 0.218387f},  {960, 0.203906f},  {1024, 0.19705f},  {1664, 0.196604f},
            {1792, 0.196161f}, {1920, 0.194501f}, {2368, 0.194455f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_fast@v5.1.0"}] = {
            {64, 0.06891f},     {128, 0.0367485f},  {192, 0.0258808f},  {256, 0.0202738f},
            {320, 0.0171969f},  {384, 0.0149813f},  {448, 0.013334f},   {512, 0.0123299f},
            {960, 0.0123197f},  {1024, 0.0120658f}, {1536, 0.0118512f}, {1664, 0.0116838f},
            {1728, 0.0115277f}, {1792, 0.0107293f}, {2496, 0.0105037f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_hac@v5.1.0"}] = {
            {64, 0.966184f},    {128, 0.488203f},   {192, 0.335054f},   {256, 0.253091f},
            {320, 0.201429f},   {384, 0.171382f},   {448, 0.146919f},   {512, 0.129982f},
            {576, 0.115659f},   {640, 0.104015f},   {704, 0.0959135f},  {768, 0.0891833f},
            {832, 0.0829841f},  {896, 0.0772927f},  {960, 0.0726533f},  {1024, 0.0685898f},
            {1088, 0.0648515f}, {1152, 0.0614344f}, {1216, 0.0589415f}, {1280, 0.0560659f},
            {1344, 0.0542818f}, {1408, 0.0515431f}, {1472, 0.0503325f}, {1536, 0.0480515f},
            {1600, 0.0464119f}, {1664, 0.0452211f}, {1728, 0.0442151f}, {1792, 0.0424949f},
            {1856, 0.041789f},  {1920, 0.0406078f}, {1984, 0.0394375f}, {2048, 0.0381242f},
            {2112, 0.0372258f}, {2176, 0.0370811f}, {2240, 0.0365515f}, {2304, 0.0355541f},
            {2368, 0.0343824f}, {2496, 0.0338468f}, {2560, 0.0328983f}, {2624, 0.0325447f},
            {2816, 0.0318458f}, {2944, 0.0310777f}, {3136, 0.0303964f}, {3200, 0.0303021f},
            {3520, 0.0302951f}, {7040, 0.0299338f},
    };

    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v5.2.0"}] = {
            {64, 0.0622515f},  {128, 0.0331957f}, {192, 0.0238102f}, {256, 0.018591f},
            {320, 0.0163448f}, {384, 0.01411f},   {448, 0.0126187f}, {512, 0.011353f},
            {832, 0.011283f},  {896, 0.010607f},  {960, 0.0103871f}, {4736, 0.0102823f},
            {8384, 0.010253f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v5.2.0"}] = {
            {64, 1.12499f},     {128, 0.566825f},   {192, 0.387772f},   {256, 0.291479f},
            {320, 0.233384f},   {384, 0.198163f},   {448, 0.168493f},   {512, 0.148648f},
            {576, 0.134425f},   {640, 0.119998f},   {704, 0.109441f},   {768, 0.101284f},
            {832, 0.0948948f},  {896, 0.0884912f},  {960, 0.0830766f},  {1024, 0.0781756f},
            {1088, 0.0739608f}, {1152, 0.0700564f}, {1216, 0.0667371f}, {1280, 0.0639407f},
            {1344, 0.0605935f}, {1408, 0.0582299f}, {1472, 0.0560869f}, {1536, 0.0538844f},
            {1600, 0.0522983f}, {1664, 0.0502008f}, {1728, 0.0488535f}, {1792, 0.0475339f},
            {1856, 0.0461768f}, {1920, 0.0448915f}, {1984, 0.0433841f}, {2048, 0.0419695f},
            {2112, 0.0412921f}, {2176, 0.0403284f}, {2240, 0.0391562f}, {2368, 0.0382881f},
            {2432, 0.0377308f}, {2496, 0.0372628f}, {2560, 0.0367681f}, {2688, 0.0362354f},
            {2752, 0.0359031f}, {2816, 0.0354022f}, {2880, 0.0346263f}, {3008, 0.0339474f},
            {3136, 0.0336849f}, {3200, 0.0330382f}, {3392, 0.0326767f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_fast@v5.2.0"}] = {
            {64, 0.0736385f},   {128, 0.0389903f},  {192, 0.027768f},   {256, 0.0216615f},
            {320, 0.0190215f},  {384, 0.0163702f},  {448, 0.014728f},   {512, 0.0132988f},
            {1472, 0.0132083f}, {1536, 0.0119098f}, {2112, 0.0113718f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_hac@v5.2.0"}] = {
            {64, 0.965347f},    {128, 0.488248f},   {192, 0.334676f},   {256, 0.25254f},
            {320, 0.20077f},    {384, 0.170685f},   {448, 0.147769f},   {512, 0.128572f},
            {576, 0.11529f},    {640, 0.104036f},   {704, 0.0963254f},  {768, 0.0878477f},
            {832, 0.0829933f},  {896, 0.0770324f},  {960, 0.072606f},   {1024, 0.0687137f},
            {1088, 0.0654062f}, {1152, 0.0617668f}, {1216, 0.0592364f}, {1280, 0.0559491f},
            {1344, 0.0552194f}, {1408, 0.051709f},  {1472, 0.0501804f}, {1536, 0.0481233f},
            {1600, 0.0469832f}, {1664, 0.0455361f}, {1728, 0.0443475f}, {1792, 0.0431213f},
            {1856, 0.0418673f}, {1920, 0.0409442f}, {1984, 0.0398894f}, {2048, 0.0387914f},
            {2112, 0.0379024f}, {2176, 0.0368082f}, {2240, 0.0365853f}, {2368, 0.0347606f},
            {2432, 0.0346622f}, {2496, 0.0339599f}, {2560, 0.0335422f}, {2624, 0.0333042f},
            {2688, 0.0325398f}, {2752, 0.0324867f}, {3072, 0.0311136f}, {3136, 0.0301029f},
            {3456, 0.0300212f},
    };
}

}  // namespace dorado::basecall
