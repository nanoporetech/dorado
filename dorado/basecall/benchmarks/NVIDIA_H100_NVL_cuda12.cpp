#include "NVIDIA_H100_NVL.h"

namespace dorado::basecall {

void AddNVIDIA_H100_NVLBenchmarks(std::map<std::pair<std::string, std::string>,
                                           std::unordered_map<int, float>>& chunk_benchmarks) {
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v4.3.0"}] = {
            {64, 0.0604025f},   {128, 0.033692f},  {192, 0.0236383f},   {256, 0.0184198f},
            {320, 0.0162697f},  {384, 0.0140735f}, {448, 0.0126876f},   {512, 0.0115794f},
            {1024, 0.0103649f}, {1472, 0.010191f}, {1536, 0.00992827f}, {2112, 0.0095475f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v5.0.0"}] = {
            {64, 0.060338f},   {128, 0.0332193f}, {192, 0.0235792f}, {256, 0.0184214f},
            {320, 0.0162572f}, {384, 0.014052f},  {448, 0.0126781f}, {512, 0.0114381f},
            {832, 0.0113163f}, {896, 0.0109453f}, {960, 0.0101719f}, {1024, 0.009719f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v4.3.0"}] = {
            {64, 0.84007f},     {128, 0.417376f},   {192, 0.289035f},   {256, 0.214484f},
            {320, 0.171339f},   {384, 0.145074f},   {448, 0.125533f},   {512, 0.110915f},
            {576, 0.0976522f},  {640, 0.088018f},   {704, 0.0820281f},  {768, 0.0738386f},
            {832, 0.0697651f},  {896, 0.0649479f},  {960, 0.0620159f},  {1024, 0.0572697f},
            {1088, 0.0543696f}, {1152, 0.0515402f}, {1216, 0.0491775f}, {1280, 0.0466099f},
            {1344, 0.0453608f}, {1408, 0.042837f},  {1472, 0.0417589f}, {1536, 0.0399173f},
            {1600, 0.0386821f}, {1664, 0.0373405f}, {1728, 0.0361232f}, {1856, 0.0343653f},
            {1920, 0.0332029f}, {1984, 0.0327066f}, {2112, 0.0313446f}, {2240, 0.030297f},
            {2304, 0.0293377f}, {2368, 0.028579f},  {2496, 0.027921f},  {2560, 0.027657f},
            {2624, 0.0274505f}, {2688, 0.026968f},  {2752, 0.0268198f}, {2880, 0.0261829f},
            {3008, 0.0253427f}, {3264, 0.0244747f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v5.0.0"}] = {
            {64, 0.936881f},    {128, 0.424511f},   {192, 0.285184f},   {256, 0.21458f},
            {320, 0.18225f},    {384, 0.145175f},   {448, 0.124702f},   {512, 0.109005f},
            {576, 0.102383f},   {640, 0.0873034f},  {704, 0.0793643f},  {768, 0.0740628f},
            {832, 0.0698442f},  {896, 0.0646683f},  {960, 0.0609647f},  {1024, 0.0573566f},
            {1088, 0.0542781f}, {1152, 0.0513223f}, {1216, 0.0489946f}, {1280, 0.0470144f},
            {1344, 0.0449849f}, {1408, 0.0427831f}, {1536, 0.0406643f}, {1600, 0.0389094f},
            {1664, 0.0387474f}, {1728, 0.0376255f}, {1792, 0.0351673f}, {1856, 0.0346211f},
            {1920, 0.033613f},  {1984, 0.0328811f}, {2048, 0.0320272f}, {2112, 0.0311295f},
            {2176, 0.0304109f}, {2240, 0.029502f},  {2304, 0.0290963f}, {2368, 0.0283228f},
            {2432, 0.0283091f}, {2496, 0.0277591f}, {2624, 0.0267126f}, {2752, 0.0263392f},
            {3008, 0.0245464f}, {3520, 0.0243204f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v4.3.0"}] = {
            {64, 2.13128f},    {128, 1.07874f},   {192, 0.721682f},  {256, 0.542825f},
            {320, 0.449492f},  {384, 0.373756f},  {448, 0.335283f},  {512, 0.288148f},
            {576, 0.277444f},  {640, 0.260923f},  {704, 0.248457f},  {768, 0.230445f},
            {896, 0.218387f},  {960, 0.203906f},  {1024, 0.19705f},  {1664, 0.196604f},
            {1792, 0.196161f}, {1920, 0.194501f}, {2368, 0.194455f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v5.0.0"}] = {
            {32, 1.06904f},   {64, 0.659935f},  {96, 0.486297f},  {128, 0.402063f},
            {160, 0.399172f}, {256, 0.371334f}, {352, 0.346864f}, {448, 0.342875f},
            {512, 0.334273f}, {640, 0.328627f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_fast@v5.1.0"}] = {
            {64, 0.06891f},     {128, 0.0367485f},  {192, 0.0258808f},  {256, 0.0202738f},
            {320, 0.0171969f},  {384, 0.0149813f},  {448, 0.013334f},   {512, 0.0123299f},
            {960, 0.0123197f},  {1024, 0.0120658f}, {1536, 0.0118512f}, {1664, 0.0116838f},
            {1728, 0.0115277f}, {1792, 0.0107293f}, {2496, 0.0105037f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_hac@v5.1.0"}] = {
            {64, 0.994028f},    {128, 0.550547f},   {192, 0.34075f},    {256, 0.258327f},
            {320, 0.213594f},   {384, 0.174351f},   {448, 0.148182f},   {512, 0.132462f},
            {640, 0.105302f},   {704, 0.0976593f},  {768, 0.0886602f},  {832, 0.0831463f},
            {896, 0.0778311f},  {960, 0.0723053f},  {1024, 0.0698615f}, {1088, 0.0650355f},
            {1152, 0.0617132f}, {1216, 0.0590287f}, {1280, 0.0559802f}, {1344, 0.0539015f},
            {1408, 0.0518557f}, {1472, 0.050391f},  {1536, 0.0479985f}, {1600, 0.0462302f},
            {1664, 0.0449848f}, {1728, 0.0437252f}, {1792, 0.0422275f}, {1856, 0.0416879f},
            {1920, 0.0402848f}, {1984, 0.0392237f}, {2048, 0.0381219f}, {2112, 0.0373906f},
            {2240, 0.0363533f}, {2368, 0.0339871f}, {2560, 0.0337946f}, {2624, 0.0334085f},
            {2816, 0.0327639f}, {2880, 0.0312725f}, {3200, 0.0301318f}, {3264, 0.0299586f},
            {3392, 0.0299015f}, {3456, 0.029888f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_sup@v5.1.0"}] = {
            {32, 1.21107f},   {64, 0.784522f}, {96, 0.58518f},   {128, 0.581281f}, {160, 0.574654f},
            {256, 0.523842f}, {288, 0.52323f}, {320, 0.504634f}, {608, 0.502565f},
    };

    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v5.2.0"}] = {
            {64, 0.0622515f},  {128, 0.0331957f}, {192, 0.0238102f}, {256, 0.018591f},
            {320, 0.0163448f}, {384, 0.01411f},   {448, 0.0126187f}, {512, 0.011353f},
            {832, 0.011283f},  {896, 0.010607f},  {960, 0.0103871f}, {4736, 0.0102823f},
            {8384, 0.010253f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v5.2.0"}] = {
            {64, 1.13078f},     {128, 0.570189f},   {192, 0.389977f},   {256, 0.290337f},
            {320, 0.23274f},    {384, 0.198462f},   {448, 0.169596f},   {512, 0.150467f},
            {576, 0.133787f},   {640, 0.119905f},   {704, 0.110657f},   {768, 0.101973f},
            {832, 0.0952933f},  {896, 0.0879864f},  {960, 0.0829221f},  {1024, 0.0782633f},
            {1088, 0.0740486f}, {1152, 0.0703071f}, {1216, 0.0670356f}, {1280, 0.0636529f},
            {1344, 0.0609511f}, {1408, 0.0586338f}, {1472, 0.0564153f}, {1536, 0.0542221f},
            {1600, 0.052299f},  {1664, 0.0503763f}, {1728, 0.0487013f}, {1792, 0.0475155f},
            {1856, 0.0458758f}, {1920, 0.0445427f}, {1984, 0.0433117f}, {2048, 0.042316f},
            {2112, 0.0411377f}, {2176, 0.0408017f}, {2240, 0.039141f},  {2304, 0.0383189f},
            {2368, 0.0379365f}, {2432, 0.0371808f}, {2560, 0.0361225f}, {2624, 0.0358528f},
            {2688, 0.0356314f}, {2752, 0.0354992f}, {2816, 0.0351383f}, {2880, 0.0342001f},
            {2944, 0.0341428f}, {3008, 0.0332792f}, {3200, 0.0330526f}, {3328, 0.0328462f},
            {3392, 0.0321174f}, {3520, 0.0319137f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_fast@v5.2.0"}] = {
            {64, 0.0736385f},   {128, 0.0389903f},  {192, 0.027768f},   {256, 0.0216615f},
            {320, 0.0190215f},  {384, 0.0163702f},  {448, 0.014728f},   {512, 0.0132988f},
            {1472, 0.0132083f}, {1536, 0.0119098f}, {2112, 0.0113718f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_hac@v5.2.0"}] = {
            {64, 0.964755f},    {128, 0.488228f},   {192, 0.333336f},   {256, 0.249958f},
            {320, 0.199796f},   {384, 0.169881f},   {448, 0.145905f},   {512, 0.129806f},
            {576, 0.115183f},   {640, 0.103903f},   {704, 0.0964042f},  {768, 0.0878046f},
            {832, 0.0819413f},  {896, 0.0774645f},  {960, 0.0720929f},  {1024, 0.0682447f},
            {1088, 0.064823f},  {1152, 0.0615187f}, {1216, 0.0586978f}, {1280, 0.0559359f},
            {1344, 0.0536345f}, {1408, 0.051582f},  {1472, 0.0500062f}, {1536, 0.0480479f},
            {1600, 0.0464669f}, {1664, 0.0449965f}, {1728, 0.0437302f}, {1792, 0.0422986f},
            {1856, 0.0412177f}, {1920, 0.0400898f}, {1984, 0.0390598f}, {2112, 0.0383207f},
            {2176, 0.0368955f}, {2240, 0.0363334f}, {2304, 0.035295f},  {2368, 0.0346689f},
            {2560, 0.0328865f}, {2624, 0.0328722f}, {2688, 0.032441f},  {2880, 0.0307379f},
            {3200, 0.0302512f}, {3264, 0.0295976f},
    };
}

}  // namespace dorado::basecall
