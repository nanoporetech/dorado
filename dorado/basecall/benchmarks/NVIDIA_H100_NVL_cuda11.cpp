#include "NVIDIA_H100_NVL.h"

namespace dorado::basecall {

void AddNVIDIA_H100_NVLBenchmarks(std::map<std::pair<std::string, std::string>,
                                           std::unordered_map<int, float>>& chunk_benchmarks) {
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v4.3.0"}] = {
            {64, 0.062883f},    {128, 0.0338585f},  {192, 0.0241372f},  {256, 0.0188453f},
            {320, 0.0165848f},  {384, 0.0143076f},  {448, 0.0128609f},  {512, 0.0118156f},
            {1024, 0.0114182f}, {2048, 0.0112693f}, {2560, 0.0105097f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v5.0.0"}] = {
            {64, 0.0632505f},  {128, 0.033826f},  {192, 0.0244055f}, {256, 0.0187992f},
            {320, 0.0167194f}, {384, 0.0143226f}, {448, 0.0129659f}, {512, 0.0116451f},
            {832, 0.0113841f}, {896, 0.0107685f}, {960, 0.010488f},  {1024, 0.0102093f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v4.3.0"}] = {
            {64, 0.331609f},    {128, 0.171068f},   {192, 0.119498f},   {256, 0.0869051f},
            {320, 0.0707959f},  {384, 0.0604026f},  {448, 0.0512148f},  {512, 0.0505731f},
            {576, 0.0412988f},  {640, 0.0385565f},  {704, 0.0352463f},  {1152, 0.035181f},
            {1216, 0.0343912f}, {1280, 0.0334497f}, {1344, 0.0328933f}, {1408, 0.0323488f},
            {2048, 0.0318909f}, {2112, 0.0312709f}, {2816, 0.0309201f}, {3328, 0.0299143f},
            {4864, 0.0299015f}, {4928, 0.0297892f}, {6976, 0.0297174f}, {7616, 0.0296879f},
            {7744, 0.0293116f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v5.0.0"}] = {
            {64, 0.355505f},    {128, 0.193595f},   {192, 0.115698f},   {256, 0.0910375f},
            {320, 0.0695721f},  {448, 0.0535017f},  {512, 0.0458574f},  {576, 0.0429163f},
            {640, 0.0379413f},  {704, 0.0361872f},  {1152, 0.0358008f}, {1216, 0.0346088f},
            {1280, 0.0333789f}, {1344, 0.0332467f}, {1408, 0.0319927f}, {2048, 0.0306422f},
            {2112, 0.0299736f}, {6272, 0.0297913f}, {6976, 0.0293181f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v4.3.0"}] = {
            {64, 2.2829f},     {128, 1.15498f},   {192, 0.778018f},  {256, 0.586073f},
            {320, 0.503646f},  {384, 0.40329f},   {448, 0.351273f},  {512, 0.318739f},
            {576, 0.29279f},   {640, 0.271874f},  {704, 0.252091f},  {768, 0.249802f},
            {832, 0.23791f},   {896, 0.226771f},  {1024, 0.207055f}, {1792, 0.206631f},
            {1856, 0.206349f}, {2048, 0.206113f}, {2112, 0.205377f}, {2240, 0.205334f},
            {2432, 0.20489f},  {2944, 0.204788f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v5.0.0"}] = {
            {32, 1.02808f},   {64, 0.748401f},  {96, 0.443304f},  {160, 0.397239f},
            {192, 0.369189f}, {256, 0.358314f}, {352, 0.35734f},  {384, 0.353609f},
            {416, 0.351887f}, {448, 0.351216f}, {480, 0.345315f}, {512, 0.329206f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_fast@v5.1.0"}] = {
            {64, 0.071001f},   {128, 0.0377305f}, {192, 0.0264783f},  {256, 0.0208981f},
            {320, 0.0175856f}, {384, 0.015165f},  {448, 0.0136674f},  {512, 0.0125191f},
            {896, 0.0119849f}, {960, 0.0113997f}, {1024, 0.0107073f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_hac@v5.1.0"}] = {
            {64, 0.411836f},    {128, 0.211592f},  {192, 0.15071f},    {256, 0.105834f},
            {320, 0.0850454f},  {384, 0.0715323f}, {448, 0.0614096f},  {512, 0.0562583f},
            {576, 0.0487642f},  {640, 0.0467456f}, {704, 0.0429239f},  {1152, 0.042622f},
            {1216, 0.0408291f}, {1280, 0.03973f},  {1408, 0.0387401f}, {1856, 0.0386976f},
            {1984, 0.0384084f}, {2112, 0.035908f}, {3456, 0.0353972f}, {9856, 0.0353533f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_sup@v5.1.0"}] = {
            {32, 1.12422f},   {64, 0.678566f},  {96, 0.57321f},   {256, 0.534661f},
            {288, 0.520192f}, {352, 0.516607f}, {480, 0.514261f}, {512, 0.512499f},
    };

    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v5.2.0"}] = {
            {64, 0.063774f},    {128, 0.0339873f},  {192, 0.0242158f},  {256, 0.018882f},
            {320, 0.016652f},   {384, 0.0143043f},  {448, 0.0128569f},  {512, 0.0115946f},
            {896, 0.0114103f},  {960, 0.0112103f},  {1024, 0.0109767f}, {1920, 0.0109663f},
            {1984, 0.0106318f}, {2048, 0.0104338f}, {7104, 0.0104126f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v5.2.0"}] = {
            {64, 0.429368f},    {128, 0.222795f},   {192, 0.150991f},   {256, 0.115339f},
            {320, 0.093667f},   {384, 0.0793911f},  {448, 0.0691099f},  {512, 0.0607877f},
            {576, 0.0556988f},  {640, 0.0513113f},  {704, 0.0485197f},  {1152, 0.047334f},
            {1216, 0.0469954f}, {1280, 0.0452477f}, {1344, 0.0444024f}, {1408, 0.0438699f},
            {1856, 0.0437283f}, {1920, 0.0423858f}, {2048, 0.0412701f}, {2560, 0.0410257f},
            {2624, 0.0409795f}, {2752, 0.0405984f}, {3520, 0.0402895f}, {4224, 0.0396057f},
            {8448, 0.03957f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_fast@v5.2.0"}] = {
            {64, 0.0767075f},  {128, 0.0402807f}, {192, 0.0286202f},  {256, 0.0223481f},
            {320, 0.0195269f}, {384, 0.0170056f}, {448, 0.0151405f},  {512, 0.0136141f},
            {896, 0.0130986f}, {960, 0.0129559f}, {1024, 0.0127634f}, {2112, 0.0113357f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_hac@v5.2.0"}] = {
            {64, 0.377905f},    {128, 0.189993f},   {192, 0.13148f},    {256, 0.0990682f},
            {320, 0.0807871f},  {384, 0.0692848f},  {448, 0.0602802f},  {512, 0.0535875f},
            {576, 0.0487289f},  {640, 0.0452956f},  {704, 0.0435173f},  {1152, 0.0429008f},
            {1216, 0.0422008f}, {1280, 0.0409536f}, {1344, 0.0401314f}, {1408, 0.0397937f},
            {1856, 0.039654f},  {1920, 0.0391532f}, {2048, 0.0384267f}, {2112, 0.0380491f},
            {2688, 0.037284f},  {3456, 0.0367855f}, {4928, 0.0366291f}, {5568, 0.0362362f},
            {7744, 0.0361461f}, {8448, 0.0360167f},
    };
}

}  // namespace dorado::basecall
