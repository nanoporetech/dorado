#include "NVIDIA_H100_NVL.h"

namespace dorado::basecall {

void AddNVIDIA_H100_NVLBenchmarks(std::map<std::pair<std::string, std::string>,
                                           std::unordered_map<int, float>>& chunk_benchmarks) {
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v4.3.0"}] = {
            {64, 0.062883f},    {128, 0.0338585f},  {192, 0.0241372f},  {256, 0.0188453f},
            {320, 0.0165848f},  {384, 0.0143076f},  {448, 0.0128609f},  {512, 0.0118156f},
            {1024, 0.0114182f}, {2048, 0.0112693f}, {2560, 0.0105097f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v5.0.0"}] = {
            {64, 0.0632505f},  {128, 0.033826f},  {192, 0.0244055f}, {256, 0.0187992f},
            {320, 0.0167194f}, {384, 0.0143226f}, {448, 0.0129659f}, {512, 0.0116451f},
            {832, 0.0113841f}, {896, 0.0107685f}, {960, 0.010488f},  {1024, 0.0102093f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v4.3.0"}] = {
            {64, 0.313787f},    {128, 0.159959f},   {192, 0.108743f},   {256, 0.082477f},
            {320, 0.0686293f},  {384, 0.0576501f},  {448, 0.0506696f},  {512, 0.0447418f},
            {576, 0.0411681f},  {640, 0.0380524f},  {704, 0.0357954f},  {1152, 0.0348759f},
            {1216, 0.0334581f}, {1280, 0.0328359f}, {1344, 0.0322799f}, {1408, 0.0313497f},
            {2048, 0.0312059f}, {2176, 0.0298851f}, {2304, 0.0287105f}, {2432, 0.0275639f},
            {2560, 0.0262424f}, {2688, 0.0255332f}, {2816, 0.0246248f}, {5632, 0.0242239f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v5.0.0"}] = {
            {64, 0.314612f},    {128, 0.160657f},   {192, 0.108977f},   {256, 0.0828314f},
            {320, 0.0685052f},  {384, 0.0580389f},  {448, 0.0509544f},  {512, 0.0447744f},
            {576, 0.0412224f},  {640, 0.0380189f},  {704, 0.0358025f},  {1152, 0.0355798f},
            {1216, 0.0342546f}, {1280, 0.033414f},  {1344, 0.0330896f}, {1408, 0.0321891f},
            {2048, 0.0311505f}, {2176, 0.0302925f}, {2304, 0.028814f},  {2432, 0.0275347f},
            {2560, 0.0265054f}, {2688, 0.0258863f}, {2816, 0.0247255f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v4.3.0"}] = {
            {64, 2.2829f},     {128, 1.15498f},   {192, 0.778018f},  {256, 0.586073f},
            {320, 0.503646f},  {384, 0.40329f},   {448, 0.351273f},  {512, 0.318739f},
            {576, 0.29279f},   {640, 0.271874f},  {704, 0.252091f},  {768, 0.249802f},
            {832, 0.23791f},   {896, 0.226771f},  {1024, 0.207055f}, {1792, 0.206631f},
            {1856, 0.206349f}, {2048, 0.206113f}, {2112, 0.205377f}, {2240, 0.205334f},
            {2432, 0.20489f},  {2944, 0.204788f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v5.0.0"}] = {
            {32, 1.02808f},   {64, 0.748401f},  {96, 0.443304f},  {160, 0.397239f},
            {192, 0.369189f}, {256, 0.358314f}, {352, 0.35734f},  {384, 0.353609f},
            {416, 0.351887f}, {448, 0.351216f}, {480, 0.345315f}, {512, 0.329206f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_fast@v5.1.0"}] = {
            {64, 0.071001f},   {128, 0.0377305f}, {192, 0.0264783f},  {256, 0.0208981f},
            {320, 0.0175856f}, {384, 0.015165f},  {448, 0.0136674f},  {512, 0.0125191f},
            {896, 0.0119849f}, {960, 0.0113997f}, {1024, 0.0107073f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_hac@v5.1.0"}] = {
            {64, 0.373493f},    {128, 0.189144f},   {192, 0.130631f},   {256, 0.0983647f},
            {320, 0.0806945f},  {384, 0.0684053f},  {448, 0.0599106f},  {512, 0.0534128f},
            {576, 0.0490894f},  {640, 0.0457015f},  {704, 0.0436745f},  {1152, 0.0429602f},
            {1216, 0.0420484f}, {1280, 0.0404417f}, {1344, 0.0391335f}, {2048, 0.037677f},
            {2176, 0.0362267f}, {2304, 0.0343041f}, {2432, 0.0334616f}, {2560, 0.0315078f},
            {2816, 0.0310162f}, {5504, 0.0308084f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_sup@v5.1.0"}] = {
            {32, 1.12422f},   {64, 0.678566f},  {96, 0.57321f},   {256, 0.534661f},
            {288, 0.520192f}, {352, 0.516607f}, {480, 0.514261f}, {512, 0.512499f},
    };

    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v5.2.0"}] = {
            {64, 0.063774f},    {128, 0.0339873f},  {192, 0.0242158f},  {256, 0.018882f},
            {320, 0.016652f},   {384, 0.0143043f},  {448, 0.0128569f},  {512, 0.0115946f},
            {896, 0.0114103f},  {960, 0.0112103f},  {1024, 0.0109767f}, {1920, 0.0109663f},
            {1984, 0.0106318f}, {2048, 0.0104338f}, {7104, 0.0104126f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v5.2.0"}] = {
            {64, 0.432806f},    {128, 0.218836f},   {192, 0.148781f},   {256, 0.113355f},
            {320, 0.0928517f},  {384, 0.078228f},   {448, 0.0685666f},  {512, 0.0607669f},
            {576, 0.0553704f},  {640, 0.0513767f},  {704, 0.0490275f},  {1152, 0.0478666f},
            {1216, 0.0466787f}, {1280, 0.0462203f}, {1344, 0.0444615f}, {1408, 0.0438438f},
            {2048, 0.0419186f}, {2176, 0.0398833f}, {2304, 0.0379458f}, {2432, 0.03615f},
            {2560, 0.0347444f}, {2688, 0.0342271f}, {2816, 0.0333346f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_fast@v5.2.0"}] = {
            {64, 0.0767075f},  {128, 0.0402807f}, {192, 0.0286202f},  {256, 0.0223481f},
            {320, 0.0195269f}, {384, 0.0170056f}, {448, 0.0151405f},  {512, 0.0136141f},
            {896, 0.0130986f}, {960, 0.0129559f}, {1024, 0.0127634f}, {2112, 0.0113357f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_hac@v5.2.0"}] = {
            {64, 0.373727f},    {128, 0.190008f},   {192, 0.131033f},   {256, 0.099526f},
            {320, 0.081272f},   {384, 0.0686049f},  {448, 0.0602989f},  {512, 0.053416f},
            {576, 0.0489434f},  {640, 0.0456669f},  {704, 0.043537f},   {1152, 0.0433834f},
            {1216, 0.0418075f}, {1280, 0.040417f},  {1408, 0.0393344f}, {2048, 0.037864f},
            {2176, 0.0359433f}, {2304, 0.0346158f}, {2432, 0.0330881f}, {2560, 0.0328748f},
            {2688, 0.030918f},  {2816, 0.0301855f},
    };
}

}  // namespace dorado::basecall
