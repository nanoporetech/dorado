#include "NVIDIA_H100_NVL.h"

namespace dorado::basecall {

void AddNVIDIA_H100_NVLBenchmarks(std::map<std::pair<std::string, std::string>,
                                           std::unordered_map<int, float>>& chunk_benchmarks) {
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_260bps_fast@v4.1.0"}] = {
            {64, 0.07382f},     {128, 0.0391462f},  {192, 0.027918f},  {256, 0.0217614f},
            {320, 0.0191133f},  {384, 0.0164647f},  {448, 0.0148208f}, {512, 0.0133725f},
            {1472, 0.0129245f}, {1536, 0.0128745f}, {1984, 0.012855f}, {2560, 0.0124945f},
            {4224, 0.0124275f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_260bps_hac@v4.1.0"}] = {
            {64, 0.606057f},    {128, 0.288076f},   {192, 0.19512f},    {256, 0.148762f},
            {320, 0.120734f},   {384, 0.100671f},   {448, 0.0869439f},  {512, 0.0760197f},
            {576, 0.0689651f},  {640, 0.062402f},   {704, 0.0605063f},  {896, 0.0601302f},
            {960, 0.0571689f},  {1024, 0.0548162f}, {1152, 0.0523703f}, {1216, 0.0492531f},
            {1408, 0.0485455f}, {2048, 0.0466333f}, {2752, 0.0461749f}, {3328, 0.0461305f},
            {3456, 0.045667f},  {3520, 0.0450296f}, {5440, 0.0449501f}, {6272, 0.0446595f},
            {6336, 0.0440606f}, {8448, 0.0425033f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_260bps_sup@v4.1.0"}] = {
            {64, 2.64732f},    {128, 1.31709f},   {192, 0.908807f},  {256, 0.678934f},
            {320, 0.574599f},  {384, 0.483317f},  {448, 0.431631f},  {512, 0.391412f},
            {640, 0.350847f},  {704, 0.335007f},  {768, 0.31882f},   {832, 0.303218f},
            {960, 0.286431f},  {1024, 0.278013f}, {1408, 0.275411f}, {1792, 0.275039f},
            {2112, 0.272482f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v4.1.0"}] = {
            {64, 0.0737665f},   {128, 0.039096f},   {192, 0.0279485f},  {256, 0.0217741f},
            {320, 0.0190957f},  {384, 0.0164675f},  {448, 0.0148816f},  {512, 0.0135024f},
            {1280, 0.0134703f}, {1408, 0.0129845f}, {1472, 0.0125137f}, {7360, 0.0124713f},
            {8000, 0.0124204f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v4.3.0"}] = {
            {64, 0.062883f},    {128, 0.0338585f},  {192, 0.0241372f},  {256, 0.0188453f},
            {320, 0.0165848f},  {384, 0.0143076f},  {448, 0.0128609f},  {512, 0.0118156f},
            {1024, 0.0114182f}, {2048, 0.0112693f}, {2560, 0.0105097f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_fast@v5.0.0"}] = {
            {64, 0.0632505f},  {128, 0.033826f},  {192, 0.0244055f}, {256, 0.0187992f},
            {320, 0.0167194f}, {384, 0.0143226f}, {448, 0.0129659f}, {512, 0.0116451f},
            {832, 0.0113841f}, {896, 0.0107685f}, {960, 0.010488f},  {1024, 0.0102093f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v4.1.0"}] = {
            {64, 0.584704f},    {128, 0.299212f},   {192, 0.196306f},   {256, 0.147846f},
            {320, 0.125112f},   {384, 0.100894f},   {512, 0.0752615f},  {576, 0.0716073f},
            {640, 0.0643413f},  {704, 0.0598245f},  {960, 0.0577359f},  {1024, 0.0550619f},
            {1088, 0.0539324f}, {1152, 0.0529977f}, {1216, 0.0511035f}, {1344, 0.0492228f},
            {1408, 0.0487029f}, {1984, 0.0479334f}, {2048, 0.0473615f}, {2112, 0.0441507f},
            {8448, 0.042906f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v4.3.0"}] = {
            {64, 0.331609f},    {128, 0.171068f},   {192, 0.119498f},   {256, 0.0869051f},
            {320, 0.0707959f},  {384, 0.0604026f},  {448, 0.0512148f},  {512, 0.0505731f},
            {576, 0.0412988f},  {640, 0.0385565f},  {704, 0.0352463f},  {1152, 0.035181f},
            {1216, 0.0343912f}, {1280, 0.0334497f}, {1344, 0.0328933f}, {1408, 0.0323488f},
            {2048, 0.0318909f}, {2112, 0.0312709f}, {2816, 0.0309201f}, {3328, 0.0299143f},
            {4864, 0.0299015f}, {4928, 0.0297892f}, {6976, 0.0297174f}, {7616, 0.0296879f},
            {7744, 0.0293116f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_hac@v5.0.0"}] = {
            {64, 0.355505f},    {128, 0.193595f},   {192, 0.115698f},   {256, 0.0910375f},
            {320, 0.0695721f},  {448, 0.0535017f},  {512, 0.0458574f},  {576, 0.0429163f},
            {640, 0.0379413f},  {704, 0.0361872f},  {1152, 0.0358008f}, {1216, 0.0346088f},
            {1280, 0.0333789f}, {1344, 0.0332467f}, {1408, 0.0319927f}, {2048, 0.0306422f},
            {2112, 0.0299736f}, {6272, 0.0297913f}, {6976, 0.0293181f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v4.1.0"}] = {
            {64, 2.61369f},    {128, 1.30978f},   {192, 0.88939f},   {256, 0.682122f},
            {320, 0.56875f},   {384, 0.489864f},  {448, 0.431239f},  {512, 0.390311f},
            {576, 0.373713f},  {640, 0.349836f},  {704, 0.337077f},  {832, 0.305748f},
            {896, 0.297723f},  {960, 0.288126f},  {1024, 0.281874f}, {1344, 0.2794f},
            {1536, 0.278807f}, {1664, 0.276251f}, {1728, 0.275324f}, {1920, 0.271697f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v4.3.0"}] = {
            {64, 2.2829f},     {128, 1.15498f},   {192, 0.778018f},  {256, 0.586073f},
            {320, 0.503646f},  {384, 0.40329f},   {448, 0.351273f},  {512, 0.318739f},
            {576, 0.29279f},   {640, 0.271874f},  {704, 0.252091f},  {768, 0.249802f},
            {832, 0.23791f},   {896, 0.226771f},  {1024, 0.207055f}, {1792, 0.206631f},
            {1856, 0.206349f}, {2048, 0.206113f}, {2112, 0.205377f}, {2240, 0.205334f},
            {2432, 0.20489f},  {2944, 0.204788f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r10.4.1_e8.2_400bps_sup@v5.0.0"}] = {
            {32, 1.02808f},   {64, 0.748401f},  {96, 0.443304f},  {160, 0.397239f},
            {192, 0.369189f}, {256, 0.358314f}, {352, 0.35734f},  {384, 0.353609f},
            {416, 0.351887f}, {448, 0.351216f}, {480, 0.345315f}, {512, 0.329206f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r9.4.1_e8_fast@v3.4"}] = {
            {64, 0.120735f},    {128, 0.0628472f},  {192, 0.0435613f},  {256, 0.0338826f},
            {320, 0.0280082f},  {384, 0.0240576f},  {448, 0.0214612f},  {512, 0.0193733f},
            {768, 0.0188985f},  {832, 0.0184369f},  {896, 0.0178207f},  {960, 0.0176958f},
            {1024, 0.0175262f}, {1472, 0.0169104f}, {7360, 0.0166269f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r9.4.1_e8_hac@v3.3"}] = {
            {64, 0.567977f},    {128, 0.295036f},   {192, 0.197482f},   {256, 0.149669f},
            {320, 0.121295f},   {384, 0.101355f},   {448, 0.089266f},   {512, 0.0763657f},
            {576, 0.071235f},   {704, 0.0596526f},  {960, 0.0565457f},  {1024, 0.0551366f},
            {1088, 0.0534138f}, {1152, 0.0513277f}, {1216, 0.0497334f}, {1280, 0.0488231f},
            {1344, 0.0480216f}, {1408, 0.0469205f}, {2112, 0.0459035f}, {2752, 0.0457078f},
            {3328, 0.0456478f}, {3456, 0.0446464f}, {4160, 0.0443867f}, {5504, 0.0429184f},
            {8448, 0.0425154f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "dna_r9.4.1_e8_sup@v3.3"}] = {
            {64, 2.23624f},    {128, 1.13438f},   {192, 0.758474f},  {256, 0.574539f},
            {320, 0.465485f},  {384, 0.395872f},  {448, 0.344749f},  {512, 0.30743f},
            {576, 0.280253f},  {640, 0.267208f},  {704, 0.255775f},  {768, 0.242326f},
            {832, 0.230916f},  {896, 0.219513f},  {960, 0.212878f},  {1024, 0.209333f},
            {1088, 0.201923f}, {1152, 0.198075f}, {1216, 0.192397f}, {1280, 0.189818f},
            {1344, 0.187872f}, {1408, 0.182891f}, {2112, 0.182779f}, {2432, 0.182718f},
            {2816, 0.182172f}, {3200, 0.181629f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_fast@v5.1.0"}] = {
            {64, 0.071001f},   {128, 0.0377305f}, {192, 0.0264783f},  {256, 0.0208981f},
            {320, 0.0175856f}, {384, 0.015165f},  {448, 0.0136674f},  {512, 0.0125191f},
            {896, 0.0119849f}, {960, 0.0113997f}, {1024, 0.0107073f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_hac@v5.1.0"}] = {
            {64, 0.411836f},    {128, 0.211592f},  {192, 0.15071f},    {256, 0.105834f},
            {320, 0.0850454f},  {384, 0.0715323f}, {448, 0.0614096f},  {512, 0.0562583f},
            {576, 0.0487642f},  {640, 0.0467456f}, {704, 0.0429239f},  {1152, 0.042622f},
            {1216, 0.0408291f}, {1280, 0.03973f},  {1408, 0.0387401f}, {1856, 0.0386976f},
            {1984, 0.0384084f}, {2112, 0.035908f}, {3456, 0.0353972f}, {9856, 0.0353533f},
    };
    chunk_benchmarks[{"NVIDIA H100 NVL", "rna004_130bps_sup@v5.1.0"}] = {
            {32, 1.12422f},   {64, 0.678566f},  {96, 0.57321f},   {256, 0.534661f},
            {288, 0.520192f}, {352, 0.516607f}, {480, 0.514261f}, {512, 0.512499f},
    };
}

}  // namespace dorado::basecall
